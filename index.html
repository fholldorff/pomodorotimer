<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.youtube.com; frame-src https://www.youtube.com; style-src 'self' 'unsafe-inline'; img-src 'self' https:; connect-src 'self' https://www.youtube.com;">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta name="referrer" content="no-referrer">
    <title>Deep Focus Timer</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <style>
        /* --- Das Design (Der Vibe) --- */
        body {
            background-color: #121212; /* Sehr dunkles Grau, fast Schwarz, toll */
            color: #ffffff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }

        .container {
            text-align: center;
        }

        h1 {
            font-weight: 300;
            letter-spacing: 2px;
            color: #888;
            margin-bottom: 40px;
            text-transform: uppercase;
            font-size: 14px;
        }

        #timer {
            font-size: 120px;
            font-weight: 700;
            font-variant-numeric: tabular-nums; /* Verhindert, dass Zahlen springen */
            color: #00e5ff; /* Neon Cyan */
            text-shadow: 0 0 20px rgba(0, 229, 255, 0.4);
            margin-bottom: 40px;
        }

        .controls button {
            background: transparent;
            border: 2px solid #333;
            color: #fff;
            padding: 15px 30px;
            font-size: 18px;
            cursor: pointer;
            border-radius: 50px;
            margin: 0 10px;
            transition: all 0.2s ease;
        }

        .controls button:hover {
            border-color: #00e5ff;
            box-shadow: 0 0 15px rgba(0, 229, 255, 0.2);
        }

        .controls button:active {
            transform: scale(0.95);
        }

        /* Der YouTube Player wird unsichtbar gemacht, muss aber da sein */
        #player-container {
            position: absolute;
            width: 1px;
            height: 1px;
            opacity: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .status {
            margin-top: 20px;
            font-size: 14px;
            color: #555;
        }

        .version {
            position: fixed;
            bottom: 10px;
            left: 10px;
            font-size: 11px;
            color: #444;
            font-family: monospace;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Deep Focus Mode</h1>
        
        <div id="timer">25:00</div>

        <div class="controls">
            <button id="start-btn">Start</button>
            <button id="pause-btn">Pause</button>
            <button id="reset-btn">Reset</button>
        </div>

        <div class="status" id="status-text">Bereit. Dr√ºcke Start f√ºr Musik & Fokus.</div>
    </div>

    <div id="player-container">
        <div id="player"></div>
    </div>

    <div class="version">v1.0.0</div>

    <script>
        /* --- Die Logik (Das Gehirn) --- */
        
        let timeLeft = 25 * 60; // 25 Minuten in Sekunden
        let timerId = null;
        let isRunning = false;
        let player;

        // 1. YouTube API laden
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        // 2. Player erstellen sobald API bereit ist
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '200',
                width: '200',
                videoId: 'jfKfPfyJRdk', // Lofi Girl Radio ID
                playerVars: {
                    'playsinline': 1
                },
                events: {
                    'onReady': onPlayerReady
                }
            });
        }

        function onPlayerReady(event) {
            console.log("Musik ist geladen!");
        }

        // 3. Timer Funktionen
        function updateDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            // F√ºgt eine Null davor, wenn die Zahl kleiner als 10 ist (09 statt 9)
            document.getElementById('timer').innerText = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function startTimer() {
            if (isRunning) return;
            
            isRunning = true;
            document.getElementById('status-text').innerText = "Fokus aktiv... üéµ";
            
            // Musik starten
            if(player && player.playVideo) {
                player.playVideo();
            }

            timerId = setInterval(() => {
                timeLeft--;
                updateDisplay();

                if (timeLeft <= 0) {
                    // Zeit abgelaufen
                    pauseTimer();
                    document.getElementById('timer').innerText = "00:00";
                    document.getElementById('status-text').innerText = "Zeit f√ºr eine Pause!";
                    alert("Fokus-Session beendet!"); 
                }
            }, 1000);
        }

        function pauseTimer() {
            clearInterval(timerId);
            isRunning = false;
            document.getElementById('status-text').innerText = "Pausiert.";
            
            // Musik pausieren
            if(player && player.pauseVideo) {
                player.pauseVideo();
            }
        }

        function resetTimer() {
            pauseTimer();
            timeLeft = 25 * 60;
            updateDisplay();
            document.getElementById('status-text').innerText = "Bereit.";

            // Musik stoppen (und zur√ºckspulen w√§re optional, aber Pause reicht)
            if(player && player.pauseVideo) {
                player.pauseVideo();
            }
        }

        // 4. Event Listeners hinzuf√ºgen (sicherer als inline onclick)
        document.getElementById('start-btn').addEventListener('click', startTimer);
        document.getElementById('pause-btn').addEventListener('click', pauseTimer);
        document.getElementById('reset-btn').addEventListener('click', resetTimer);
    </script>
</body>
</html>